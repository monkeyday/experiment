const Svg={o:[],Text(a){return React.createElement('text',{x:a.x,y:a.y,dx:a.dx,dy:a.dy,rotate:a.r,fill:a.f,stroke:a.s,strokeWidth:a.b,strokeDasharray:a.d,fontSize:a.fs,fontWeight:a.fw,textAnchor:a.a,opacity:a.o,onCopy:a.evt},a.t)},SubText(a){return React.createElement('tspan',{x:a.x,y:a.y,dx:a.dx,dy:a.dy,fill:a.f,stroke:a.s,strokeWidth:a.b,strokeDasharray:a.d,fontSize:a.fs,fontWeight:a.fw,opacity:a.o},a.t)},LinkText(a){return React.createElement('a',{href:a.l,target:'_blank'},React.createElement('text',{x:a.x,y:a.y,dx:a.dx,dy:a.dy,fill:a.f,stroke:a.s,strokeWidth:a.b,strokeDasharray:a.d,fontSize:a.fs,fontWeight:a.fw,opacity:a.o},a.t))},Line(a){return React.createElement('line',{x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2,stroke:a.s,strokeWidth:a.b,strokeDasharray:a.d,strokeLinecap:a.l,opacity:a.o})},Rect(a){return React.createElement('rect',{x:a.x,y:a.y,width:a.w,height:a.h,fill:a.f,stroke:a.s,strokeWidth:a.b,strokeDasharray:a.d,opacity:a.o,fillOpacity:a.fo,strokeOpacity:a.so,transform:a.t,onClick:a.evt})},CRect(a){let b=a.x-a.w/2,c=a.y-a.h/2;return React.createElement(Svg.Rect,{x:b,y:c,w:a.w,h:a.h,f:a.f,b:a.b,s:a.s,t:a.t,o:a.o,evt:a.evt})},RRect(a){return React.createElement('rect',{x:a.x,y:a.y,width:a.w,height:a.h,fill:a.f,stroke:a.s,strokeWidth:a.b,strokeDasharray:a.d,rx:a.rx,ry:a.ry,opacity:a.o,fillOpacity:a.fo,strokeOpacity:a.so,transform:a.t,onClick:a.evt,onDrag:a.evt,draggable:!0})},Circle(a){return React.createElement('circle',{cx:a.x,cy:a.y,r:a.r,fill:a.f,stroke:a.s,strokeWidth:a.b,strokeDasharray:a.d,opacity:a.o})},Dot(a){return React.createElement('circle',{cx:a.x,cy:a.y,r:a.r,fill:a.f,opacity:a.o})},Ellipse(a){return React.createElement('ellipse',{cx:a.cx,cy:a.cy,rx:a.rx,ry:a.ry,fill:a.f,stroke:a.s,strokeWidth:a.b,strokeDasharray:a.d,opacity:a.o})},Polygon(a){a.p.forEach((b)=>{b[0]+=a.x,b[1]+=a.y});let b=a.p.reduce((a,b)=>(a.push(b.join(',')),a),[]).join(' ');return React.createElement('polygon',{points:b,fill:a.f,fillRule:a.r,stroke:a.s,strokeWidth:a.b,strokeDasharray:a.d,opacity:a.o,onClick:a.evt,ref:a.dom})},Polyline(a){a.p.forEach((b)=>{b[0]+=a.x,b[1]+=a.y});let b=a.p.reduce((a,b)=>(a.push(b.join(',')),a),[]).join(' ');return React.createElement('polyline',{points:b,fill:a.f,stroke:a.s,strokeWidth:a.b,strokeDasharray:a.d,opacity:a.o})},Path(a){return React.createElement('path',{d:a.d('p_code','avg_price'),fill:a.f,stroke:a.s,strokeWidth:a.b,strokeDasharray:a.sd,opacity:a.o})},Round(c){let d=[],a=[],b=c.s.reduce((b,c)=>(-1==b.indexOf(c.p_code)&&(b.push(c.p_code),a.push(c)),b),[]);return b.forEach((b,e)=>{d.push(React.createElement('g',{key:e},React.createElement(Svg.Text,{key:'t'+e,x:c.xS(a[e].m_name),y:c.yS(a[e].avg_price),dx:5,dy:-5,f:c.ca[e%20],b:1,d:'1,2',fs:12,fw:600,o:1,t:a[e].avg_price}),React.createElement(Svg.Circle,{key:'c'+e,x:c.xS(a[e].m_name),y:c.yS(a[e].avg_price),r:c.rS(a[e].amount),s:c.ca[e%20],f:c.color(a[e].amount),b:1,o:0.7})))}),React.createElement('g',null,d)},Position(b){let c=[];for(let d=0;d<b.i;d++){let f=b.e?b.s+(b.e-b.s)/(b.i-1)*d:b.s+360/b.i*d,a=f*Math.PI/180,g=b.x+b.R*Math.cos(a),h=b.y-b.R*Math.sin(a),j=React.createElement(b.t,{x:g,y:h,key:d,w:b.w,h:b.h,f:b.f,o:0.5,a:b.a,s:b.ss},null);c.push(j)}return React.createElement('g',{fill:'blue',strokeWidth:'5'},c)},Poly(b){let c=[];for(let d=b.i;0<d;d--){let e=360/b.i-(180-360/b.i)/2,f=e+360/b.i*d,a=f*Math.PI/180,g=b.x+b.R*Math.cos(a),h=b.y-b.R*Math.sin(a);c.push([g,h])}return React.createElement(Svg.Polygon,{x:b.o.x,y:b.o.y,p:c,f:'url(#LG1)',r:'nonzero',s:'url(#RG1)',b:3,d:'5,4',o:0.3,dom:b.dom})},Parallelogram(b){var c=Math.tan;let d=[],e=b.a*Math.PI/180,f=b.x-b.w/2-b.h/2/c(e),g=b.y+b.h/2;return d.push([f,g],[f+b.w,g],[f+b.w+b.h/c(e),g-b.h],[f+b.h/c(e),g-b.h]),React.createElement(Svg.Polygon,{x:0,y:0,p:d,f:'url(#LG1)',r:'nonzero',s:'url(#RG1)',b:3,d:'5,4',o:0.3,dom:b.dom})},Triangle(d){var e=Math.pow,f=Math.sin,g=Math.cos,i=Math.PI;let j=[],k=d.w/2*Math.tan(d.a*i/180),h=d.s*i/180,l=Math.atan(k/d.w),b=Math.sqrt(e(k/2,2)+e(d.w/2,2));return j.push([d.x-g(h+l)*b,d.y+f(h+l)*b],[d.x+g(h-l)*b,d.y-f(h-l)*b],[d.x-g(i/2-h)*k/2,d.y-f(i/2-h)*k/2]),React.createElement(Svg.Polygon,{x:0,y:0,p:j,f:'url(#LG1)',r:'nonzero',s:'url(#RG1)',b:3,d:'5,4',o:0.3,dom:d.dom})},Gradient(b){let c=[];return b.s.forEach((a,b)=>c.push(React.createElement('stop',{key:b,offset:a.f,stopColor:a.c,stopOpacity:a.o}))),'l'==b.t?React.createElement('linearGradient',{id:b.id,x1:b.x1,x2:b.x2,y1:b.y1,y2:b.y2},c):React.createElement('radialGradient',{id:b.id,cx:b.x,cy:b.y,r:b.r,fx:b.fx,fy:b.fy},c)},Grid(b){let c=[];for(let a=0;a<=b.w;a+=b.c)c.push(React.createElement(Svg.Line,{key:'c'+a,x1:a,y1:0,x2:a,y2:b.h,s:b.s,b:b.b,d:b.d}));for(let a=0;a<=b.h;a+=b.r)c.push(React.createElement(Svg.Line,{key:'r'+a,x1:0,y1:a,x2:b.w,y2:a,s:b.s,b:b.b,d:b.d}));return React.createElement('g',null,c)},Clip(a){return React.createElement('clipPath',{id:a.id})},Mask(a){return React.createElement('mask',{id:a.id})},D(a){return React.createElement('div',{ref:a.dom},'Drag')},evt(a){a.preventDefault(),console.dir(a.nativeEvent),console.dir(Svg.o)},dom(a){Svg.o.push(a)}};class SVG extends React.Component{constructor(a){super(a),this.state={D:a.d,N:a.d.length,G:{W:800,H:800,P:100,M:10},C:d3.scaleOrdinal(d3.schemeCategory20).range(),X:0,Y:0},this.xS=(a)=>d3.scaleBand().domain(this.state.D.map((b)=>b[a])).rangeRound([0,this.state.G.W-2*this.state.G.P]),this.yS=(a)=>d3.scaleLinear().domain([d3.min(this.state.D,(b)=>b[a]),d3.max(this.state.D,(b)=>b[a])]).range([this.state.G.H-2*this.state.G.P,0]),this.rS=(a)=>d3.scaleSqrt().domain([d3.min(this.state.D,(b)=>b[a]),d3.max(this.state.D,(b)=>b[a])]).range([0,this.state.G.W/10]),this.color=(a)=>d3.scaleSequential(d3.interpolateRainbow).domain([d3.min(this.state.D,(b)=>b[a]),d3.max(this.state.D,(b)=>b[a])]),this.date=d3.scaleTime().domain([new Date('2017-01-01'),new Date(d3.max(this.state.D,(a)=>a.date))]).range([0,this.state.G.W-2*this.state.G.P]),this.path=this.path.bind(this),this.click=this.click.bind(this),this.evt=this.evt.bind(this)}componentDidMount(){let a=d3.axisBottom(this.xS('m_name')).ticks(10),b=d3.axisLeft(this.yS('avg_price')).ticks(10),c=d3.axisBottom(this.date).ticks(d3.timeMonth.every(1));d3.select('#x').call(a),d3.select('#y').call(b),d3.select('#d').call(c),$(()=>{this.polyg=$(Svg.o[1]),this.polyg.draggable({addClasses:!1,stop:(a,b)=>{console.dir(this.polyg[1].points);let c=a.clientX,d=a.clientY;for(let e of this.polyg[1].points)e.x+=c,e.y+=d;console.dir(this.polyg[1].points),console.dir(b.position)},helper:'clone',zIndex:1})})}path(a,c){let d=d3.path(),f=[],b=this.state.D.reduce((b,c)=>(-1==b.indexOf(c[a])&&(b.push(c[a]),f.push(c)),b),[]);return b.forEach((b,e)=>{let g=this.xS(a)(f[e][a]),h=this.yS(c)(f[e][c]);0==e?d.moveTo(0,h):d.lineTo(g,h)}),d.toString()}click(a){console.log(a.target.value),this.setState({D:this.state.D.filter((b)=>b.p_code==a.target.value)})}evt(a){console.dir(a.target)}onDragOver(a){a.preventDefault(),console.log('onDragOver')}onDragStart(a){a.dataTransfer.setData('id','setTheId'),console.log('onDragStart')}onDrop(){console.log('onDrop');var a=event.dataTransfer.getData('id');console.log('Dropped with id:',a)}render(){return React.createElement('svg',{id:'graph',width:this.state.G.W,height:this.state.G.H,style:{margin:this.state.G.M,padding:this.state.G.P},version:'1.1',xmlns:'http://www.w3.org/2000/svg'},React.createElement('defs',null,React.createElement(Svg.Gradient,{id:'RG1',t:'r',s:[{f:'0%',c:'green'},{f:'30%',c:'yellow'},{f:'60%',c:'orange'},{f:'100%',c:'purple',o:0.5}]}),React.createElement(Svg.Gradient,{id:'LG1',t:'l',s:[{f:'0%',c:'green'},{f:'30%',c:'yellow'},{f:'60%',c:'orange'},{f:'100%',c:'purple',o:0.5}]})),React.createElement('g',null,React.createElement(Svg.Rect,{x:0,y:0,w:this.state.G.W-2*this.state.G.P,h:this.state.G.H-2*this.state.G.P,f:'#ffc',s:'#cf9',b:3}),React.createElement(Svg.Line,{x1:0,x2:100,y1:0,y2:100,s:'#f9f',b:2,d:'5,4',l:'round'}),React.createElement(Svg.Dot,{x:150+this.state.X,y:150+this.state.Y,f:'black',o:1}),React.createElement(Svg.Round,{s:this.state.D,xS:this.xS('m_name'),yS:this.yS('avg_price'),rS:this.rS('amount'),color:this.color('amount'),ca:this.state.C})),React.createElement(Svg.Path,{d:this.path,s:'grey',f:'none'}),React.createElement('path',{d:'M100 100 C 80 200, 270 200, 250 100 S 420 0, 400 100, 570 200, 550 100',fill:'transparent',stroke:'orange',strokeWidth:3}),React.createElement('path',{d:'M100 300 Q 150 350, 200 300 T 300 300, 400 300',fill:'transparent',stroke:'olive',strokeWidth:3}),React.createElement('g',{id:'x'}),React.createElement('g',{id:'y'}),React.createElement('g',{id:'d',transform:`translate(0, ${this.state.G.H-2*this.state.G.P})`}))}}